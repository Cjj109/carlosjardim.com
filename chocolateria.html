<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Chocolate Shop - Selecciona tu chocolate favorito">
  <meta name="author" content="Carlos Jardim">
  <meta name="theme-color" content="#1a0a0a">
  <meta name="robots" content="noindex, nofollow">

  <title>Chocolate Shop</title>

  <!-- Favicon -->
  <link rel="icon" type="image/svg+xml" href="/favicon.svg">

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&family=JetBrains+Mono:wght@400;500;600;700&display=swap">

  <!-- Styles (NO base.css - interfiere con el layout standalone) -->
  <link rel="stylesheet" href="css/variables.css">
  <link rel="stylesheet" href="css/age-gate.css">

  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }

    body {
      min-height: 100vh;
      background: linear-gradient(135deg, #1a0a0a 0%, #2d1810 50%, #1a0a0a 100%);
      color: #fff;
      font-family: var(--font-sans, 'Inter', sans-serif);
      overflow-x: hidden;
    }

    /* ‚îÄ‚îÄ Gate Card (inline - viene de pong.css en la pag principal) ‚îÄ‚îÄ */
    .gate-card {
      text-align: center;
      font-family: var(--mono, 'JetBrains Mono', monospace);
      color: #fff;
      width: 90%;
      max-width: 380px;
      position: relative;
      border: 1px solid #333;
      padding: 30px;
      border-radius: 16px;
      background: #050505;
      box-shadow: 0 0 0 1px rgba(255, 59, 48, 0.08);
    }

    .gate-card button {
      display: block;
      width: 100%;
      margin: 12px 0;
      padding: 16px;
      background: transparent;
      border: 1px solid #333;
      color: #fff;
      cursor: pointer;
      font-family: var(--mono, 'JetBrains Mono', monospace);
      transition: 0.2s ease;
      border-radius: 6px;
      text-transform: uppercase;
      letter-spacing: 1px;
      font-size: 12px;
    }

    .gate-card button:hover {
      border-color: #fff;
      background: rgba(255, 255, 255, 0.05);
    }

    .gate-step-text {
      letter-spacing: 2px;
      font-size: 12px;
      margin-bottom: 20px;
      color: #888;
    }

    .close-gate {
      position: absolute;
      top: 14px;
      right: 18px;
      color: #555;
      font-size: 20px;
      cursor: pointer;
      transition: 0.2s ease;
      background: none;
      border: none;
    }

    .close-gate:hover { color: #fff; }

    /* ‚îÄ‚îÄ Header ‚îÄ‚îÄ */
    .choco-page-header {
      text-align: center;
      padding: 40px 20px 20px;
    }

    .choco-page-title {
      font-size: clamp(28px, 6vw, 48px);
      font-weight: 900;
      color: #ffd700;
      font-family: var(--mono, 'JetBrains Mono', monospace);
      text-shadow: 0 4px 12px rgba(255, 215, 0, 0.4);
      margin-bottom: 8px;
    }

    .choco-page-subtitle {
      font-size: 15px;
      color: rgba(255, 255, 255, 0.5);
      margin-bottom: 8px;
    }

    .choco-back-link {
      color: rgba(255, 255, 255, 0.4);
      text-decoration: none;
      font-size: 13px;
      font-family: var(--mono, 'JetBrains Mono', monospace);
      transition: color 0.2s;
    }

    .choco-back-link:hover {
      color: #ffd700;
    }

    /* ‚îÄ‚îÄ Grid directo (sin modal) ‚îÄ‚îÄ */
    .choco-page-content {
      max-width: 750px;
      margin: 0 auto;
      padding: 20px;
      width: 100%;
    }

    .choco-slot-section {
      text-align: center;
      margin-bottom: 24px;
    }

    .choco-slot-btn {
      background: linear-gradient(135deg, #ffd700 0%, #ffed4e 50%, #ffd700 100%);
      border: 2px solid #b8860b;
      border-radius: 12px;
      padding: 14px 32px;
      font-size: 18px;
      font-weight: 700;
      color: #8b4513;
      cursor: pointer;
      font-family: var(--mono, 'JetBrains Mono', monospace);
      letter-spacing: 1px;
      transition: all 0.2s;
      box-shadow: 0 6px 20px rgba(255, 215, 0, 0.3);
    }

    .choco-slot-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 28px rgba(255, 215, 0, 0.5);
    }

    .choco-slot-hint {
      font-size: 12px;
      color: rgba(255, 255, 255, 0.35);
      margin-top: 8px;
    }

    /* ‚îÄ‚îÄ Chocolates Grid ‚îÄ‚îÄ */
    .choco-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 16px;
      margin-bottom: 30px;
      width: 100%;
    }

    .choco-card {
      background: rgba(139, 69, 19, 0.2);
      border: 2px solid rgba(139, 69, 19, 0.4);
      border-radius: 12px;
      padding: 20px;
      cursor: pointer;
      transition: all 0.2s;
      text-align: center;
      position: relative;
      overflow: hidden;
    }

    .choco-card:hover {
      background: rgba(139, 69, 19, 0.3);
      border-color: rgba(255, 215, 0, 0.6);
      transform: translateY(-6px);
      box-shadow: 0 12px 24px rgba(0, 0, 0, 0.4);
    }

    .choco-card.arrested {
      box-shadow: inset 0 0 0 3px rgba(100, 100, 100, 0.5);
      cursor: not-allowed;
      opacity: 0.6;
      pointer-events: none;
    }

    .choco-card.arrested::before {
      content: '';
      position: absolute;
      inset: 0;
      background: repeating-linear-gradient(90deg, transparent 0px, transparent 18px, rgba(60,60,60,0.8) 18px, rgba(60,60,60,0.8) 22px);
      pointer-events: none;
      z-index: 2;
      border-radius: 12px;
    }

    .choco-card.arrested .choco-card-name::after {
      content: ' üîí';
      font-size: 0.85em;
    }

    .choco-card img {
      width: 100px;
      height: 100px;
      object-fit: cover;
      border-radius: 50%;
      margin-bottom: 12px;
      border: 3px solid rgba(255, 215, 0, 0.3);
      transition: all 0.2s;
    }

    .choco-card:hover img {
      border-color: #ffd700;
    }

    .choco-card-name {
      font-size: 18px;
      font-weight: 700;
      color: #ffd700;
      margin-bottom: 6px;
    }

    .choco-card-status {
      display: inline-block;
      background: rgba(255, 200, 0, 0.2);
      border: 1px solid rgba(255, 200, 0, 0.5);
      color: #ffc800;
      padding: 3px 10px;
      border-radius: 20px;
      font-size: 10px;
      font-weight: 600;
      letter-spacing: 0.5px;
    }

    .choco-card-status.extreme {
      background: rgba(255, 50, 0, 0.2);
      border-color: rgba(255, 50, 0, 0.5);
      color: #ff5533;
    }

    /* ‚îÄ‚îÄ Detail View ‚îÄ‚îÄ */
    .choco-detail-overlay {
      display: none;
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.9);
      z-index: 1000;
      overflow-y: auto;
      align-items: center;
      justify-content: center;
      padding: 20px;
    }

    .choco-detail-overlay.active {
      display: flex;
    }

    .choco-detail-card {
      background: linear-gradient(135deg, #2d1810 0%, #1a0a0a 100%);
      border: 2px solid rgba(255, 215, 0, 0.3);
      border-radius: 16px;
      padding: 40px 30px;
      max-width: 500px;
      width: 100%;
      text-align: center;
      animation: fadeInUp 0.3s ease;
    }

    @keyframes fadeInUp {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .choco-detail-card img {
      width: 160px;
      height: 160px;
      object-fit: cover;
      border-radius: 50%;
      border: 4px solid #ffd700;
      margin-bottom: 20px;
    }

    .choco-detail-name {
      font-size: 28px;
      font-weight: 900;
      color: #ffd700;
      margin-bottom: 12px;
    }

    .choco-detail-status {
      display: inline-block;
      background: rgba(255, 200, 0, 0.2);
      border: 1px solid rgba(255, 200, 0, 0.5);
      color: #ffc800;
      padding: 4px 14px;
      border-radius: 20px;
      font-size: 12px;
      font-weight: 600;
      margin-bottom: 16px;
    }

    .choco-detail-status.extreme {
      background: rgba(255, 50, 0, 0.2);
      border-color: rgba(255, 50, 0, 0.5);
      color: #ff5533;
    }

    .choco-detail-desc {
      font-size: 15px;
      line-height: 1.7;
      color: rgba(255, 255, 255, 0.8);
      margin-bottom: 24px;
    }

    .choco-detail-actions {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .choco-detail-btn {
      display: inline-block;
      padding: 12px 24px;
      border-radius: 10px;
      font-size: 15px;
      font-weight: 600;
      cursor: pointer;
      border: none;
      transition: all 0.2s;
      font-family: var(--font-sans, 'Inter', sans-serif);
      text-decoration: none;
      text-align: center;
    }

    .choco-detail-btn.primary {
      background: linear-gradient(135deg, #ffd700, #ffed4e);
      color: #8b4513;
    }

    .choco-detail-btn.primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(255, 215, 0, 0.4);
    }

    .choco-detail-btn.secondary {
      background: rgba(255, 255, 255, 0.08);
      color: rgba(255, 255, 255, 0.7);
      border: 1px solid rgba(255, 255, 255, 0.15);
    }

    .choco-detail-btn.secondary:hover {
      background: rgba(255, 255, 255, 0.15);
      color: #fff;
    }

    /* ‚îÄ‚îÄ Slot Machine ‚îÄ‚îÄ */
    .choco-slot-container {
      display: none;
      text-align: center;
      margin: 20px 0;
    }

    .choco-slot-container.active {
      display: block;
    }

    .choco-slot-viewport {
      height: 300px;
      overflow: hidden;
      border: 3px solid rgba(255, 215, 0, 0.5);
      border-radius: 12px;
      background: rgba(0, 0, 0, 0.5);
      position: relative;
      margin-bottom: 20px;
    }

    .choco-slot-reel {
      transition: transform 3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    }

    .choco-slot-reel.spinning {
      animation: slotSpin 0.2s linear infinite;
    }

    @keyframes slotSpin {
      from { transform: translateY(0); }
      to { transform: translateY(-700px); }
    }

    .choco-slot-item {
      height: 100px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .choco-slot-item img {
      width: 70px;
      height: 70px;
      object-fit: cover;
      border-radius: 50%;
      border: 2px solid rgba(255, 215, 0, 0.4);
    }

    /* ‚îÄ‚îÄ Footer ‚îÄ‚îÄ */
    .choco-page-footer {
      text-align: center;
      padding: 10px 20px 40px;
      color: rgba(255, 255, 255, 0.3);
      font-size: 12px;
      font-family: var(--mono, 'JetBrains Mono', monospace);
    }

    /* ‚îÄ‚îÄ Mobile ‚îÄ‚îÄ */
    @media (max-width: 500px) {
      .choco-grid {
        grid-template-columns: repeat(2, 1fr);
        gap: 12px;
      }

      .choco-card img {
        width: 80px;
        height: 80px;
      }

      .choco-card-name {
        font-size: 15px;
      }

      .choco-detail-card {
        padding: 30px 20px;
      }

      .choco-detail-card img {
        width: 120px;
        height: 120px;
      }
    }
  </style>
</head>

<body>
  <!-- Header -->
  <header class="choco-page-header">
    <div class="choco-page-title">üç´ Chocolate Shop</div>
    <div class="choco-page-subtitle">Selecciona tu chocolate favorito</div>
    <a href="/" class="choco-back-link">‚Üê carlosjardim.com</a>
  </header>

  <!-- Content -->
  <main class="choco-page-content">
    <!-- Slot Machine Button -->
    <div class="choco-slot-section" id="slotSection">
      <button class="choco-slot-btn" onclick="startDirectSlot()">
        üé∞ SLOT MACHINE
      </button>
      <div class="choco-slot-hint">Deja que la suerte decida</div>
    </div>

    <!-- Slot Machine Animation -->
    <div class="choco-slot-container" id="directSlotContainer">
      <div class="choco-slot-viewport">
        <div id="directSlotReel" class="choco-slot-reel"></div>
      </div>
    </div>

    <!-- Chocolates Grid -->
    <div class="choco-grid" id="directChocGrid"></div>
  </main>

  <footer class="choco-page-footer">
    Un proyecto de carlosjardim.com
  </footer>

  <!-- Detail Overlay -->
  <div class="choco-detail-overlay" id="chocoDetailOverlay">
    <div class="choco-detail-card" id="chocoDetailCard"></div>
  </div>

  <!-- Age Gate Modal (mismas clases que index.html) -->
  <div class="age-gate-overlay gate-style" id="ageGateModal" role="dialog" aria-modal="true" aria-label="Verificaci√≥n de edad">
    <div class="gate-card">
      <div class="close-gate" onclick="closeAgeGateModal()" role="button" tabindex="0" aria-label="Cerrar">‚úï</div>
      <p class="gate-step-text">¬øEres mayor de 18?</p>
      <button onclick="handleAgeGateResponse(true)">S√≠</button>
      <button onclick="handleAgeGateResponse(false)">No</button>
    </div>
  </div>

  <!-- Police Arrest Overlay -->
  <div class="police-arrest-overlay" id="policeArrestOverlay" onclick="closePoliceArrest()">
    <div class="police-arrest-content">
      <div class="police-lights">
        <div class="police-light red"></div>
        <div class="police-light blue"></div>
      </div>
      <div class="arrest-text">¬°Chocolate detenido! üöî</div>
      <div class="arrest-subtext">Este bomb√≥n es para mayores de 18</div>
      <div class="arrest-dismiss">Toca para cerrar</div>
    </div>
  </div>

  <!-- Closet Overlay (para Anthonny) -->
  <div class="closet-overlay" id="closetOverlay" onclick="closeCloset()">
    <div class="closet-content">
      <div class="closet-wardrobe">
        <div class="closet-top"></div>
        <div class="closet-body">
          <div class="closet-inside">
            <div class="closet-peek">üëÄ</div>
            <div class="closet-hanger">üß•</div>
          </div>
          <div class="closet-door-left">
            <div class="closet-slat"></div>
            <div class="closet-slat"></div>
            <div class="closet-slat"></div>
            <div class="closet-knob"></div>
          </div>
          <div class="closet-door-right">
            <div class="closet-slat"></div>
            <div class="closet-slat"></div>
            <div class="closet-slat"></div>
            <div class="closet-knob"></div>
          </div>
        </div>
        <div class="closet-base"></div>
      </div>
      <div class="closet-text">Se escondi√≥ en el closet</div>
      <div class="closet-subtext">Este bomb√≥n no quiere salir</div>
      <div class="closet-dismiss">Toca para cerrar</div>
    </div>
  </div>

  <!-- Load age-gate first (provides showAgeGate, etc.) -->
  <script src="js/age-gate.js"></script>

  <script>
    // ‚îÄ‚îÄ Chocolate data (inline, no dependency on chocolate-shop.js modal logic) ‚îÄ‚îÄ
    const chocolates = {
      jesus: {
        name: "Jes√∫s", image: "images/Jesus.webp", instagram: "@elyizus",
        status: "extremadamente apartado",
        description: "Dulce en fase beta. En un d√≠a de Luz se derriti√≥ y dio como resultado otro dulce. Hoy vive una vida tranquila comiendo perros calientes y jugando LoL. No sale en el test de compatibilidad porque es incompatible con otra mujer (nadie fue amenazado para escribir esto)."
      },
      miguel: {
        name: "Miguel Acosta", image: "images/Miguel.webp", instagram: "@miguex94",
        status: "apartado",
        description: "En su momento fue el terror de cierto sitio que a √©l no le gusta mencionar ¬øhoy? Su vida gira alrededor de la iglesia y la fe. Un hombre totalmente cambiado y apartado ¬øsu sabor? Solo para una."
      },
      zachiro: {
        name: "Zachiro", image: "images/Zachiro.webp", instagram: "@zachiroj",
        status: null,
        description: "El primer asi√°tico nacido de dos padres venezolanos. Fan√°tico de los videojuegos. Cuenta con una moto y un tatuaje de un n√∫mero. Dispuesto a tatuarse tu nombre, pero solo si tienes el sabor correcto."
      },
      anthonny: {
        name: "Anthonny", image: "images/Anthonny.webp", instagram: "@anthonny.123",
        status: "apartado",
        description: "El Benjam√≠n Button del cabello. Ya a los 13 a√±os ten√≠a barba, lo que hac√≠a que lo expulsaran de sitios para menores ¬øel problema? Su cabello ya hab√≠a vivido lo suficiente y decidi√≥ abandonarlo ¬øhoy? Gracias a un viaje a Rusia volvi√≥ a encontrar el camino de Head & Shoulders. Este es un dulce tipo Di Caprio (no apto para mayores de 23)."
      },
      ricardo: {
        name: "Ricardo", image: "images/Ricardo.webp", instagram: "@radsl",
        status: null,
        description: "Este caramelo es conocido por partir. Tiene prohibici√≥n de venta en Tanaguarenas. Con ligero sabor y olor a pollo a la brasa y con un trauma a los carros Chrysler (con este le pago la universidad al hijo de su mec√°nico)."
      },
      mike: {
        name: "Miguel Angelo", image: "images/Mike.webp", instagram: "@miguel267",
        status: null,
        description: "De fabricaci√≥n venezolana, pero actualmente se encuentra en el mercado estadounidense. Su mayor miedo en la actualidad es el hielo (ICE). Cuenta con un legendario movimiento de caderas que le gan√≥ el apodo de Magic Mike (de ah√≠ se inspir√≥ la pel√≠cula)."
      },
      david: {
        name: "David Pereira", image: "images/David.webp", instagram: "@davidapereiraf",
        status: null,
        description: "Este chocolate era un poco m√°s blanco, pero se dor√≥ (de m√°s) en sus viajes a Los Caracas. Su sue√±o es encontrar una alemana que disfrute su sabor ¬øel problema? Hoy est√° m√°s cerca del lado oscuro."
      }
    };

    const FALLBACK_IMG = "data:image/svg+xml;utf8," + encodeURIComponent(
      "<svg xmlns='http://www.w3.org/2000/svg' width='200' height='200' viewBox='0 0 200 200'>" +
      "<rect width='200' height='200' fill='#24150f'/>" +
      "<circle cx='100' cy='80' r='40' fill='#6b3d1f'/>" +
      "<text x='100' y='160' text-anchor='middle' fill='#ffd700' font-size='16'>üç´</text></svg>"
    );

    const arrestedChocolates = new Set();

    // ‚îÄ‚îÄ Render Grid ‚îÄ‚îÄ
    function renderGrid() {
      const grid = document.getElementById('directChocGrid');
      if (!grid) return;

      grid.innerHTML = Object.keys(chocolates).map(key => {
        const c = chocolates[key];
        const arrested = arrestedChocolates.has(key) ? ' arrested' : '';
        const statusHtml = c.status
          ? `<div class="choco-card-status${c.status === 'extremadamente apartado' ? ' extreme' : ''}">${c.status === 'extremadamente apartado' ? 'üö® EXTREMADAMENTE APARTADO' : '‚ö†Ô∏è APARTADO'}</div>`
          : '';

        return `
          <div class="choco-card${arrested}" onclick="showDetail('${key}')">
            <img src="${c.image}" alt="${c.name}" loading="lazy" onerror="this.onerror=null;this.src='${FALLBACK_IMG}'">
            <div class="choco-card-name">${c.name}</div>
            ${statusHtml}
          </div>`;
      }).join('');
    }

    // ‚îÄ‚îÄ Show Detail ‚îÄ‚îÄ
    function showDetail(key) {
      if (arrestedChocolates.has(key)) return;

      const c = chocolates[key];
      if (!c) return;

      const overlay = document.getElementById('chocoDetailOverlay');
      const card = document.getElementById('chocoDetailCard');

      const statusHtml = c.status
        ? `<div class="choco-detail-status${c.status === 'extremadamente apartado' ? ' extreme' : ''}">${c.status === 'extremadamente apartado' ? 'üö® EXTREMADAMENTE APARTADO' : '‚ö†Ô∏è APARTADO'}</div>`
        : '';

      card.innerHTML = `
        <img src="${c.image}" alt="${c.name}" onerror="this.onerror=null;this.src='${FALLBACK_IMG}'">
        <div class="choco-detail-name">${c.name}</div>
        ${statusHtml}
        <div class="choco-detail-desc">${c.description}</div>
        <div class="choco-detail-actions">
          <button class="choco-detail-btn primary" onclick="viewProfile('${key}')">Ver Perfil</button>
          <button class="choco-detail-btn secondary" onclick="closeDetail()">Volver</button>
        </div>`;

      overlay.classList.add('active');
    }

    function closeDetail() {
      document.getElementById('chocoDetailOverlay').classList.remove('active');
    }

    // ‚îÄ‚îÄ View Profile (con age gate) ‚îÄ‚îÄ
    function viewProfile(key) {
      const c = chocolates[key];
      if (!c) return;

      closeDetail();

      showAgeGate('chocolate', () => {
        window.open('https://instagram.com/' + c.instagram.replace('@', ''), '_blank', 'noopener,noreferrer');
      }, (k) => {
        arrestedChocolates.add(k);
        renderGrid();
      }, key);
    }

    // ‚îÄ‚îÄ Slot Machine ‚îÄ‚îÄ
    function startDirectSlot() {
      const container = document.getElementById('directSlotContainer');
      const reel = document.getElementById('directSlotReel');
      const gridEl = document.getElementById('directChocGrid');
      const slotSection = document.getElementById('slotSection');

      if (!container || !reel) return;

      if (gridEl) gridEl.style.display = 'none';
      if (slotSection) slotSection.style.display = 'none';
      container.classList.add('active');

      const keys = Object.keys(chocolates);
      const items = [];
      for (let i = 0; i < 20; i++) {
        keys.forEach(k => items.push({ key: k, image: chocolates[k].image }));
      }

      reel.innerHTML = items.map(item =>
        `<div class="choco-slot-item" data-key="${item.key}">
          <img src="${item.image}" alt="${chocolates[item.key].name}">
        </div>`
      ).join('');

      const winnerKey = keys[Math.floor(Math.random() * keys.length)];
      const itemHeight = 100;
      const middleItem = Math.floor(items.length / 2);
      let winnerPos = middleItem;
      for (let i = middleItem; i < items.length; i++) {
        if (items[i].key === winnerKey) { winnerPos = i; break; }
      }

      const finalPos = -(winnerPos * itemHeight) + 150 - (itemHeight / 2);

      reel.classList.add('spinning');

      setTimeout(() => {
        reel.classList.remove('spinning');
        reel.style.transform = `translateY(${finalPos}px)`;

        setTimeout(() => {
          container.classList.remove('active');
          if (gridEl) gridEl.style.display = '';
          if (slotSection) slotSection.style.display = '';
          showDetail(winnerKey);

          setTimeout(() => {
            reel.style.transition = 'none';
            reel.style.transform = 'translateY(0)';
            setTimeout(() => {
              reel.style.transition = 'transform 3s cubic-bezier(0.25, 0.46, 0.45, 0.94)';
            }, 50);
          }, 300);
        }, 800);
      }, 2000);
    }

    // ‚îÄ‚îÄ Close detail on overlay click ‚îÄ‚îÄ
    document.getElementById('chocoDetailOverlay').addEventListener('click', function(e) {
      if (e.target === this) closeDetail();
    });

    // ‚îÄ‚îÄ ESC key ‚îÄ‚îÄ
    document.addEventListener('keydown', function(e) {
      if (e.key === 'Escape') {
        closeDetail();
      }
    });

    // ‚îÄ‚îÄ Init ‚îÄ‚îÄ
    renderGrid();
  </script>
</body>
</html>
